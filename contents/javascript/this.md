---
date: '2023-09-25'
title: '[JS]this'
categories: ['Web', 'javascript', 'this']
summary: 'this에 관하여'
thumbnail: './this.png'
---

객체지향 프로그래밍의 객체는 생태를 나타내는 프로퍼티와 동작을 나타내는 메서드가 하나의 논리적 단위로 묶여있는 복합적인 자료구조이다.

여기서 메서드는 자신이 속한 객체의 프로퍼티 값에 접근할 수 있어야 하고 그것을 변경 가능해야한다.

#### this 키워드를 사용하기 이전 방식

객체 리터럴 방식으로 생성된 객체의 경우는 내부에서 메서드 자신이 속한 객체를 가리키는 식별자를 재귀적으로 참조할 수 있다.

```JavaScript
const circle = {
	radius: 5,
	getDiameter() {
		return 2 * circle.radius;
	};
};

circle.getDiameter(); // => 10
```

하지만 위 방법은 생성자 함수를 통해 인스턴스를 생성했을 때 문제가 발생한다.

```JavaScript
function Circle(radius) {
	// 인스턴스가 생성 됐을 때 자신을 가리키는 식별자를 알 수 없다.
	?.radius = radius;
}

Circle.prototype.getDiameter = function() {
	// 인스턴스가 생성 됐을 때 자신을 가리키는 식별자를 알 수 없다.
	return 2 * ?.radius;
};

const circle = new Circle(5);
```

#### this

위 예시와 다르게 this는 자기 참조 변수로서 자신이 속한 객체 또는 자신이 생성할 인스턴스를 가리킬 수 있다. 이를 자기 참조 변수라고 한다.

this는 자바스크립트 엔진에 의해 암묵적으로 생성되며, 코드 어디서든지 참조할 수 있다.

함수를 호출하게 되면 arguments와 this가 암묵적으로 생성되고, 이를 지역변수처럼 활용할 수 있다. 단 this가 바인딩하는 대상은 함수 호출의 방식에 따라 동적으로 결정되며, strict mode 또한 this 바인딩에 영향을 준다.

|  함수 호출 방식  |          this 바인딩          |
| :--------------: | :---------------------------: |
|  일반 함수 호출  |           전역 객체           |
|   메서드 호출    |     메서드를 호출한 객체      |
| 생성자 함수 호출 | 생성자 함수가 생성할 인스턴스 |

예를 들어 일반 함수에서의 this는 전역 객체 window를 가리키며, 메서드 내부에서는 메서드를 호출한 객체를 가리킨다. 그리고 생성자 함수 내부에서의 this는 생성자 함수가 생성할 인스턴스를 가리키게된다.

여기서 주의할 점은 렉시컬 스코프와 this 바인딩의 결정 시기가 다르다는 것이다.

렉시컬 스코프는 함수 정의가 평가되어 함수 객체가 생성되는 시점에 상위 스코프를 결정하지만, this 바인딩은 함수가 호출되는 시점에서 결정된다.

#### strict mode 에서의 this 바인딩

this의 본 목적은 객체의 프로퍼티나 메서드를 참조하기 위한 자기 참조 변수이다. 이 말은 객체의 내부 또는 생성자 함수 내부에서만 의미가 있다. 따라서 strict mode가 적용된 일반함수의 this는 undefined를 바인딩 하게된다.

#### 화살표 함수의 this

ES6 부터 화살표 함수가 추가 되었다. 화살표 함수는 prototype을 갖지 않는다. 그러므로 this 키워드 자체가 없으며, 화살표 함수 내부에서 this 키워드를 사용할 경우 해당 화살 표함수의 상위 함수의 this 바인딩을 따르게 된다.

## Source

- 이웅모, 모던 자바스크립트 Deep Dive, 위키북스, 2020
